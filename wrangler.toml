# -------------------
# Base (local / default)
# -------------------
name = "prod-staging-dexgram-userdb-api"
compatibility_date = "2024-12-01"
main = "src/index.ts"

# Cron (commun)
[triggers]
crons = ["*/5 * * * *"]

[env.prod.vars]
CLEANUP_INTERVAL_SECONDS = "5"
INCO_DOMAIN_EXPIRATION_MINUTES = "1440"
LINK_DOMAIN_EXPIRATION_MINUTES = "525600"
MAX_USERNAME_SUFFIX_ATTEMPTS = "10"
MIN_USERNAME_Z_VALUE = "10"
MAX_USERNAME_Z_VALUE = "9999"

# -------------------
# PROD
# -------------------
[env.prod]
name = "prod-dexgram-userdb-api"
workers_dev = false
staging_urls = false
routes = [
  { pattern = "prod-userdb.dexgram.app/*", zone_name = "dexgram.app" }
]


[[env.prod.d1_databases]]
binding = "DB_INCO"
database_name = "prod-dexgram-inco-db"
database_id = "c24996c5-440e-4763-9a42-3993fd7d8c72"

[[env.prod.d1_databases]]
binding = "DB_LINK"
database_name = "prod-dexgram-link-db"
database_id = "c612ae4a-1a42-41c3-bf91-e8542f0ee3f2"


# -------------------
# STAGING
# -------------------
[env.staging]
name = "staging-dexgram-userdb-api"
workers_dev = false
staging_urls = false
routes = [
  { pattern = "staging-userdb.dexgram.app/*", zone_name = "dexgram.app" }
]


[[env.staging.d1_databases]]
binding = "DB_INCO"
database_name = "dexgram-inco-db-staging"
database_id = "905040ab-a782-4201-9857-e01c1cd1f9ea"

[[env.staging.d1_databases]]
binding = "DB_LINK"
database_name = "dexgram-link-db-staging"
database_id = "5605a518-eabb-492e-b82d-f2ee97ef465a"
